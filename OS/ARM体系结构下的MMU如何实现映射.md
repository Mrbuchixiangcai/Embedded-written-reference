## ARM体系结构下的MMU如何实现映射

1. 创建内核页表，映射所有物理内存和IO空间，对于不同的处理器，该函数差别比较大。

   ```
    paging_init(&meminfo, mdesc) 
   ```

### ARM下的MMU

1. 在ARM存储系统中，使用内存管理单元(MMU)实现虚拟地址到实际物理地址的映射。
2. 利用MMU
   + 可把**SDRAM**(动态RAM中的一种)的地址，完全映射到**0x0**起始的一片**连续地址**空间，
   + 而把原来占据这片空间的FLASH或者ROM映射到其他**不相冲突**的存储空间位置。
3. **通过MMU的映射，则可实现程序完全运行在SDRAM之中**
   + 在实际的应用中，可能会把两片不连续的物理地址空间分配给SDRAM。
   + 而在**操作系统**中，习惯于把SDRAM的空间连续起来，方便内存管理，且应用程序申请大块的内存时，操作系统内核也可方便地分配。
   + 通过MMU可实现不连续的物理地址空间映射为连续的虚拟地址空间。
   + 操作系统内核或者一些比较关键的代码，一般是不希望被用户应用程序访问。通过MMU可以控制地址空间的访问权限，从而保护这些代码不被破坏。 
4. **MMU的实现过程，实际上就是一个查表映射的过程**。
   + 建立页表是实现MMU功能不可缺少的一步。
   + 页表位于系统的内存中，页表的每一项对应于一个虚拟地址到物理地址的映射。
   + 每一项的长度即是一个字的长度(在ARM中，一个字的长度被定义为4Bytes)。
   + 页表项除完成虚拟地址到物理地址的映射功能之外，还定义了访问权限和缓冲特性等。 
5. **MMU的映射分为两种，一级页表的变换和二级页表变换**
   + 两者的不同之处就是实现的变换地址空间大小不同。 
   + 一级页表变换支持1 M大小的存储空间的映射，而二级可以支持64 kB，4 kB和1 kB大小地址空间的映射。

### ARM通过几级页表实现存储空间映射

1. 采用的两级页表进行地址映射
   - 一级页表中：包含段为单位的地址变换条目或者指向二级页表的指针，一级页表实现地址的映射颗粒度较大；
   - 二级页表中：分为大页，小页，和极小页为单位的地址变换条目；